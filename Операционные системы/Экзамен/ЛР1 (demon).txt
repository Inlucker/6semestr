Лаба 1
Запустить перед сдачей
1) id процесса id группы id сессии - 3 одинаковые (лидер группы лидер сессии и в этой группе он один)
2) Показать информацию о демоне в системе
почему у демона такой parent id? - завершили процесс потомок, демон усиротел и произошло усыновление терминальным процессом
3) функцией demonize создаем новый процесс и завершаем процесс предок
4) id группы - демон один в своей группы
5) ? отсутствует управляющий терминала
6) -1 около tpgid означает что у него нет терминала и нет терминальной группы
7) S/s/L - что означает
S - interruptable sleep большую часть времени они спят - прерываемый сон
s - лидер сесиии
L - процесс многопоточен
8) точка в коде где процесс становится демоном - вызов функции демонайз
9) функция алреади ранинг - обеспечить запуск процесса в одном экземпляре, делается с помощью открытия файла и записи туда id процесса
10) системный вызов control в lockfile передаем дескриптор файла и ключ сет лок и указатель на структуру в которой блокируем файл на запись
11) условие вызова set sid процесс должен быть лидером группы, завершаем процесс родитель
функция setsid делает лидером группы и лидером сессии и отбирает управляющий терминал
12) отбираем управляющий терминал потому что демоны предназначены для выполнения определенных функций связаных с сервисом и влиять на него работу через терминал запрещено
13) где мы запускаем дополнительный поток??
какие действия sighub?????
в демоне устанавливаем игнорирование сигхаб почему?
Сигхаб - сигнал который сообщает процессу о потеря управляющего терминала
У демонов нет управляющего терминала поэтому мы отключаем реакцию на сигхаб
Сетсид блокирует обработку сигхаба, перед тем как вызвать сетсид убиваем предка
в мейне восстанавливается реагция на сигхаб по умолчанию

1) Что нужно сделать перед вызовом setsid - создать новый процесс потомок и завершить процесс предок
2) Что делаем с сигналом sighub в функции daemonize и что это за сигнал. - сигнал, который процесс получает если он утратил управляющий терминал (процесс завершается), чтобы этого не произошло используем функцию sig_action, которая в результате вызова будет игнорировать сигнал сигах
3) У вас установлен странный pid, почему? - Процесс предок завершили и произошло усыновление каким-то user-init/shell-portal
4) umask из какого процесса вызываем из parent'а или из child'а, (из parant'а)
почему из parent'а? (Для сбрасывания режима создания файлов)
(Это возможно потому что потомок унаследует сброшенную маску)
5) Самое важное в структуре... - то что файл блокируется
6) Что нужно сделать с дескрипторами открытых файлов (~закрыть)
7) Что вы делаете с сигналом, чтобы его обрабатывать?
8) Файл блокировки надо удалять (remove();)